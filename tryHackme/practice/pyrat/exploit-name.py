from pwn import *

host = "10.10.115.77"
port = 8000

endpoints_file = "filtered.txt"

def connect_to_service():
    return remote(host, port)
def attempt_endpoint(endpoint):
    conn = connect_to_service()

    conn.sendline(endpoint.encode())

    response = conn.recvline(timeout=2)
    
    if b"name '" + endpoint.encode() + b"' is not defined\n" in response:
        conn.close()
        return False
    else:
        print(f"Endpoint {endpoint} might be correct")
        conn.close()
        return True

def fuzz_endpoint():
    with open(endpoints_file, "r", encoding="latin-1") as f:
        for endpoint in f:
            endpoint = endpoint.strip()
            
            if endpoint.startswith("#") or not endpoint:
                continue
            if attempt_endpoint(endpoint):
                print(f"Found working endpoint: {endpoint}")
                break


if __name__ == "__main__":
    fuzz_endpoint()

